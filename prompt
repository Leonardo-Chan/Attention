接下来我将提供代码，你首先对题目进行拆解，然后分析实现代码的思路，然后逐行对代码进行详细解释，然后分析时间和空间复杂度，最后给出acm模式的完整代码，要处理所有的定义，输入和输出，整个过程确保语言直白明确，直指本质


